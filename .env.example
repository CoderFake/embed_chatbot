# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
ENV=dev
APP_NAME=Chatbot Embed Platform
APP_VERSION=1.0.0
API_V1_PREFIX=/api/v1
TIMEZONE=Asia/Ho_Chi_Minh

# API Documentation - Open access in dev
DOCS_USERNAME=admin
DOCS_PASSWORD=admin

# =============================================================================
# DOCKER EXPOSED PORTS
# =============================================================================
POSTGRES_PORT=15432
REDIS_PORT=16379
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001
MILVUS_PORT=19532
CRAWL4AI_PORT=11235
API_PORT=18000

# =============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# =============================================================================
POSTGRES_DB=chatbot_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_postgres_password_here
POSTGRES_INTERNAL_HOST=postgres
POSTGRES_INTERNAL_PORT=5432

# Connection Pool Settings
DB_ECHO=false
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_DB=0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# =============================================================================
# CACHE TTL CONFIGURATION (seconds)
# =============================================================================
CACHE_DEFAULT_TTL=3600
CACHE_USER_TTL=3600
CACHE_BOT_TTL=3600
CACHE_DOCUMENT_TTL=1800
CACHE_VISITOR_TTL=1800
CACHE_PROVIDER_TTL=7200
CACHE_MODEL_TTL=7200
CACHE_BOT_CONFIG_TTL=3600
CACHE_ALLOWED_ORIGINS_TTL=3600
CACHE_ANALYTICS_OVERVIEW_TTL=300
CACHE_ANALYTICS_BOT_TTL=300
CACHE_LIST_TTL=600
CACHE_BLACKLIST_TTL=86400
CACHE_RATE_LIMIT_TTL=60

# =============================================================================
# MINIO CONFIGURATION (Object Storage)
# =============================================================================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin_password
MINIO_BUCKET_NAME=chatbot-documents
MINIO_PUBLIC_URL=https://your-minio-domain.com

# =============================================================================
# MILVUS CONFIGURATION (Vector Database)
# =============================================================================
MILVUS_USER=
MILVUS_PASSWORD=
MILVUS_VECTOR_DIM=768

# =============================================================================
# CRAWL4AI CONFIGURATION
# =============================================================================
CRAWL4AI_API_TOKEN=your-crawl4ai-api-token-here
CRAWL4AI_TIMEOUT=30

# =============================================================================
# JWT & AUTHENTICATION
# =============================================================================
JWT_SECRET_KEY=your-jwt-secret-key-min-32-characters-change-this
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
WIDGET_TOKEN_EXPIRE_HOURS=1
INVITE_TOKEN_EXPIRE_DAYS=7

# =============================================================================
# PASSWORD & ENCRYPTION
# =============================================================================
PASSWORD_MIN_LENGTH=8
PASSWORD_RESET_EXPIRE_HOURS=1
# SECRET_KEY is used for encrypting sensitive data (API keys, provider configs)
SECRET_KEY=your-secret-key-min-32-characters-change-this
# Generate: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=your-encryption-key-base64-encoded-32-bytes

# =============================================================================
# ROOT USER (Initial Setup)
# =============================================================================
# This user will be created automatically on first startup
ROOT_EMAIL=admin@example.com
ROOT_PASSWORD=YourSecurePassword123

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_WIDGET_PER_MINUTE=20
RATE_LIMIT_IP_PER_MINUTE=100

# =============================================================================
# EMBEDDING MODEL CONFIGURATION
# =============================================================================
EMBEDDING_MODEL_NAME=intfloat/multilingual-e5-base
EMBEDDING_DEVICE=cpu
EMBEDDING_BATCH_SIZE=32

# =============================================================================
# TEXT PROCESSING
# =============================================================================
CHUNK_SIZE=512
CHUNK_OVERLAP=128

# =============================================================================
# FILE SERVER - RABBITMQ CONFIGURATION
# =============================================================================
# RabbitMQ runs internally in file-server container
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/
RABBITMQ_QUEUE_NAME=file_processing_queue
RABBITMQ_PREFETCH_COUNT=1

# Backend Webhook
BACKEND_WEBHOOK_URL=http://backend:8000/api/v1/webhooks/file-processing-update
BACKEND_WEBHOOK_SECRET=your-backend-webhook-secret-min-32-characters

# File Server Workers
FILE_SERVER_WORKER_POOL_SIZE=4
FILE_SERVER_WORKER_MAX_RETRIES=3
FILE_SERVER_WORKER_RETRY_DELAY=5

# File Server Batch Processing
FILE_SERVER_MINIO_BATCH_SIZE=100
FILE_SERVER_MILVUS_BATCH_SIZE=1000

# File Server Progress
FILE_SERVER_PROGRESS_MIN_DELTA=5.0
FILE_SERVER_PROGRESS_MIN_INTERVAL=3.0
FILE_SERVER_PROGRESS_STATE_TTL=3600

# File Server Logging
FILE_SERVER_LOG_LEVEL=INFO

# =============================================================================
# CRAWL CONFIGURATION
# =============================================================================
CRAWL_MAX_PAGES=100
CRAWL_MAX_DEPTH=3
CRAWL_MAX_CONCURRENT=5
CRAWL_PROGRESS_INTERVAL=5

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
CORS_ORIGINS=["https://your-frontend-domain.com"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["*"]
CORS_ALLOW_HEADERS=["*"]

# =============================================================================
# EMAIL CONFIGURATION (Optional - Disabled in dev)
# =============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_TLS=true
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-email-app-password
EMAIL_FROM=your-email@gmail.com
EMAIL_FROM_NAME=${APP_NAME}
EMAIL_TEMPLATES_DIR=app/static/templates
FRONTEND_URL=https://your-frontend-domain.com
BACKEND_URL=https://your-backend-domain.com

# =============================================================================
# BACKGROUND TASKS
# =============================================================================
WORKER_CONCURRENCY=4
JOB_TIMEOUT=3600
WORKER_COUNT=2
JOB_QUEUE_TIMEOUT=5
JOB_DATA_TTL=86400

# =============================================================================
# MONITORING (Optional - Disabled in dev)
# =============================================================================
SENTRY_DSN=
ENABLE_METRICS=false

# =============================================================================
# GUNICORN CONFIGURATION
# =============================================================================
WORKERS=4
PORT=8000
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=100
TIMEOUT=120
GRACEFUL_TIMEOUT=60
KEEP_ALIVE=5
LOG_LEVEL=info

# =============================================================================
# CHAT WORKER - RABBITMQ CONFIGURATION
# =============================================================================
CHAT_QUEUE_NAME=chat_processing_queue
RETRIEVAL_TOP_K=20
RERANK_MODEL=BAAI/bge-reranker-base
MAX_CONCURRENT_CHAT_TASKS=10

# =============================================================================
# VISITOR LEAD GRADING CONFIGURATION
# =============================================================================
# Visitor Grading Queue & Webhook
VISITOR_GRADING_QUEUE=visitor_grading_queue
VISITOR_GRADER_WEBHOOK_URL=http://backend:8000/api/v1/webhooks/visitor-grading
VISITOR_GRADER_PREFETCH_COUNT=1
VISITOR_GRADER_RECONNECT_DELAY=5
VISITOR_GRADER_WEBHOOK_TIMEOUT=30
VISITOR_GRADER_WEBHOOK_MAX_RETRIES=3
VISITOR_GRADER_LOG_LEVEL=INFO

# Lead Scoring Thresholds (0-100 scale)
HOT_LEAD_THRESHOLD=70
WARM_LEAD_THRESHOLD=40

# Grading Output Language (vietnamese, english, etc.)
GRADING_OUTPUT_LANGUAGE=vietnamese


RABBITMQ_DEFAULT_USER=admin
RABBITMQ_DEFAULT_PASS=your-rabbitmq-password
